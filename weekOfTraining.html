<!DOCTYPE html>
<html lang="en">
<head>
  <link rel="icon" href="Images/GTRRLogo.png" type="image/png">
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Week of Training | Georgia Tech Running Club</title>
  <link href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700;900&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
  <style>
    /* Add-on styles just for the training table */
    .training-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1em;
      font-family: 'Lato', sans-serif;
      font-size: 1rem;
    }

    .training-table th {
      background-color: #f7f7f7;
      font-weight: 700;
      text-align: left;
      padding: 0.75em 1em;
      border-bottom: 2px solid #e0e0e0;
    }

    .training-table td {
      padding: 0.6em 1em;
      border-bottom: 1px solid #eee;
    }

    .training-table tr:nth-child(even) {
      background-color: #fafafa;
    }

    

    .training-table caption {
      caption-side: top;
      font-size: 1.1rem;
      font-weight: 700;
      text-align: left;
      margin-bottom: 0.5em;
      color: #333;
    }

    @media (max-width: 700px) {
      .training-table th, .training-table td {
        font-size: 0.9rem;
        padding: 0.5em;
      }
    }
  </style>
</head>
<body>
  <a class="skip-link" href="#main">Skip to content</a>

  <header class="site-header" role="banner">
    <div class="container nav-wrap">
      <div id="branding" class="branding">
        <a class="brand-link" href="index.html" aria-label="Runnin' Wreck home">
          <img src="Images/GTRRLogo.png" alt="GTRR Logo" style="height:2.2em;vertical-align:middle;">
          <span class="brand-text"><span class="highlight">Runninâ€™ Wreck</span></span>
        </a>
      </div>

      <button class="nav-toggle" aria-expanded="false" aria-controls="primary-nav">
        <span class="nav-toggle-bar" aria-hidden="true"></span>
        <span class="nav-toggle-bar" aria-hidden="true"></span>
        <span class="nav-toggle-bar" aria-hidden="true"></span>
        <span class="sr-only">Menu</span>
      </button>

      <nav id="primary-nav" class="primary-nav" role="navigation" aria-label="Primary">
        <ul>
          <li><a href="index.html">Home</a></li>
          <li><a href="about.html">About Us</a></li>
          <li><a href="schedule.html">Schedule</a></li>
          <li class="current"><a aria-current="page" href="weekOfTraining.html">Week of Training</a></li>
          <li><a href="join.html">How to Join</a></li>
          <li><a href="https://gtvault-my.sharepoint.com/:w:/g/personal/tboucino3_gatech_edu/EYoHQx2gJ0ZNiV92icKnjhABl0Ng4OHK6NYGoXoewUHABw?e=5N7mCp" target="_blank" rel="noopener">Team Hub</a></li>
        </ul>
      </nav>
    </div>
  </header>

  <main id="main" class="container content" role="main">
    <section class="card card--pad-lg">
      <h1>Training</h1>
      <div id="training-data"></div>
      <p id="loading-msg" style="margin-left:1.5rem;">Data may take a second to load.</p>
    </section>
  </main>
  <script>
  const apiURL =
    "https://script.googleusercontent.com/macros/echo?user_content_key=AehSKLhQWeVbU3SAC2Te8dAyHcfAy3XKhYxSWM4p0IJFQCqDE-VDuFTU3NGwCZ70kCSg_x7VuVZm3-sm1tMdEE-jt5RKjdOsk8xNCMYzv62vS9VTKpdpOdYOdW50vJahJT97dN2yr1BfeOWYyVK0pbOnQI_SjxUORwv96CqRMXsKfhm3k27DFJYPAsVHFquEvGxbECwhQGGszbCyQtrkUpvibPOvcDRmEHyQl_d2nWo0zLhJVWSYDrYdu9E_g4_NFJLDuxX-11XI9ssG0QMtd7qChDXOYazy_4Zkil6vg3UT&lib=MFIn001NRq5VrBW4hotLJniJkt3D8Y0Py";

  async function loadTrainingData() {
    const loadingMsg = document.getElementById("loading-msg");
    const container = document.getElementById("training-data");

    // Show loading message
    if (loadingMsg) {
      loadingMsg.style.display = "block";
      loadingMsg.textContent = "Loading training data...";
    }

    try {
      const res = await fetch(apiURL);
      if (!res.ok) throw new Error("Network error");
      const data = await res.json();
      renderTrainingTable(data);

      // Hide loading message after successful load
      if (loadingMsg) loadingMsg.style.display = "none";
    } catch (err) {
      console.error("Failed to load training data:", err);
      if (container)
        container.innerHTML = "<p style='color:red;'>Error loading data.</p>";
      if (loadingMsg) {
        loadingMsg.textContent = "Failed to load training data.";
        loadingMsg.style.color = "red";
      }
    }
  }

  function renderTrainingTable(data) {
    const container = document.getElementById("training-data");
    if (!Array.isArray(data)) {
      container.innerHTML = "<p>Invalid data format.</p>";
      return;
    }

    let html = `
      <table class="training-table">
        <caption>Week of ${
          data[0]
            ? Object.keys(data[0])[0].split(" ")[1] +
              " " +
              Object.keys(data[0])[0].split(" ")[2] +
              ", " +
              Object.keys(data[0])[0].split(" ")[3]
            : ""
        }</caption>
        <thead>
          <tr>
            <th>Day</th>
            <th>Mileage</th>
            <th>Workout</th>
            <th>Safety Officer 1</th>
            <th>Safety Officer 2</th>
            <th>Route</th>
          </tr>
        </thead>
        <tbody>
    `;

    for (const entry of data) {
      const day = Object.values(entry)[0] || "";
      html += `
        <tr>
          <td>${day}</td>
          <td>${entry.Mileage || ""}</td>
          <td>${entry.Workout || ""}</td>
          <td>${entry.SO1 || ""}</td>
          <td>${entry.SO2 || ""}</td>
          <td>${entry.Route || ""}</td>
        </tr>
      `;
    }

    html += `
        </tbody>
      </table>
    `;

    container.innerHTML = html;
  }

  document.addEventListener("DOMContentLoaded", loadTrainingData);
</script>

  </body>
</html>
